---
export const prerender = true;
import axios from "axios";
import MainBanner from "../components/MainBanner.astro";
import Layout from "../layouts/Layout.astro";
import * as AstroFeather from "astro-feather";
import { queryStringToObject } from "../helpers/queryHelper";
import { products as dummyProducts } from "../constants/data";
import Oauth1Helper from "../helpers/authHelper";

let products = null;

const queryString = queryStringToObject(new URL(Astro.url));

const request = {
  url: "https://server.moreo.pk/wp-json/wc/v3/products",
  method: "GET",
};

const authHeader = Oauth1Helper.getAuthHeaderForRequest(request);

axios
  .get(request.url, { headers: authHeader })
  .then((res) => {
    products = res.data
  })
  .catch((err) => {
    console.log(err,"ERROR");
  });
---

<Layout title="Explore your aesthetics">
  <main>
    <MainBanner />

    <div class="max-w-screen-xl flex flex-wrap justify-between mx-auto py-4">
      <div class="w-1/5 pr-5">
        <a
          href={"/"}
          class={`rounded-xl flex h-20 items-center justify-between p-4 bg-gray-light text-black hover:bg-primary hover:text-white ${
            !queryString.category ? "bg-primary text-white" : ""
          }`}
        >
          <p class="font-extrabold text-md italic">HOME</p>
          <AstroFeather.HomeIcon />
        </a>
        <a
          href={"?category=new-in"}
          class={`mt-3 h-20 rounded-xl flex items-center justify-between p-4 bg-gray-light text-black hover:bg-primary hover:text-white ${
            queryString.category === "new-in" ? "bg-primary text-white" : ""
          }`}
        >
          <p class="font-extrabold text-md italic">NEW IN</p>
          <AstroFeather.ZapIcon />
        </a>
        <a
          href={"?category=coats"}
          class={`mt-3 h-20 rounded-xl flex items-center justify-between p-4 bg-gray-light text-black hover:bg-primary hover:text-white ${
            queryString.category === "coats" ? "bg-primary text-white" : ""
          }`}
        >
          <p class="font-extrabold text-md italic">COATS</p>
          <AstroFeather.ActivityIcon />
        </a>
        <a
          href={"?category=tops"}
          class={`mt-3 h-20 rounded-xl flex items-center justify-between p-4 bg-gray-light text-black hover:bg-primary hover:text-white ${
            queryString.category === "tops" ? "bg-primary text-white" : ""
          }`}
        >
          <p class="font-extrabold text-md italic">TOPS</p>
          <AstroFeather.ActivityIcon />
        </a>
        <a
          href={"?category=bottoms"}
          class={`mt-3 h-20 rounded-xl flex items-center justify-between p-4 bg-gray-light text-black hover:bg-primary hover:text-white ${
            queryString.category === "bottoms" ? "bg-primary text-white" : ""
          }`}
        >
          <p class="font-extrabold text-md italic">BOTTOMS</p>
          <AstroFeather.ActivityIcon />
        </a>
        <a
          href={"?category=jewellery"}
          class={`mt-3 h-20 rounded-xl flex items-center justify-between p-4 bg-gray-light text-black hover:bg-primary hover:text-white ${
            queryString.category === "jewellery" ? "bg-primary text-white" : ""
          }`}
        >
          <p class="font-extrabold text-md italic">JEWELLERY</p>
          <AstroFeather.ActivityIcon />
        </a>
      </div>

      <div class="w-4/5 pl-5">
        <div>
          <h2 class="font-extrabold italic text-4xl text-transform: uppercase">
            {queryString.category ? queryString.category : "HOME"}
          </h2>
          <a
            href={`/category?slug=${queryString.category}`}
            class="font-bold text-sm">View More</a
          >
        </div>

        <div class="flex flex-wrap mt-5">
          <a
            href={"/"}
            class="rounded-xl flex h-12 items-center justify-between px-6 py-4 border-gray-light border-2"
          >
            <AstroFeather.SlidersIcon size={18} />
            <p class="ml-5 font-bold text-md">Sort</p>
          </a>
          <a
            href={"/"}
            class="ml-5 rounded-xl flex h-12 items-center justify-between px-6 py-4 border-gray-light border-2"
          >
            <p class="font-bold text-md">Product Type</p>
          </a>
          <a
            href={"/"}
            class="ml-5 rounded-xl flex h-12 items-center justify-between px-6 py-4 border-gray-light border-2"
          >
            <p class="font-bold text-md">Style</p>
          </a>
          <a
            href={"/"}
            class="ml-5 rounded-xl flex h-12 items-center justify-between px-6 py-4 border-gray-light border-2"
          >
            <p class="font-bold text-md">Size</p>
          </a>
          <a
            href={"/"}
            class="ml-5 rounded-xl flex h-12 items-center justify-between px-6 py-4 border-gray-light border-2"
          >
            <p class="font-bold text-md">Color</p>
          </a>
          <a
            href={"/"}
            class="ml-5 rounded-xl flex h-12 items-center justify-between px-6 py-4 border-gray-light border-2"
          >
            <p class="font-bold text-md">Price Range</p>
          </a>
        </div>
        <div class="flex flex-wrap mt-5 w-100">
          {JSON.stringify(products)}
          {
            dummyProducts.map((item) => (
              <a
                href={`/product?slug=${item.id}`}
                class="w-1/3
			              rounded-xl
			              flex
			              flex-col
			              items-center
			              justify-center
			              p-4
			              h-96
			              "
              >
                <div
                  class={`	
			            bg-[url('${item.image}')]
			            bg-cover
			            bg-center
                  h-full
                  w-full
                  rounded-2xl
                  m-4
                  `}
                />
                <h4>{item.name}</h4>
              </a>
            ))
          }
        </div>
      </div>
    </div>
  </main>
</Layout>
